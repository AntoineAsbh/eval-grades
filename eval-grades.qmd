---
title: "Eval-grades"
author: "Antoine Calvayrac"
format: html
---

library
```{r}
#| message: false
library(here)
here::i_am("eval-grades.Rproj")
library(dplyr)
library(ggplot2)
library(tidyr)
library(readr)
```
Question 1:

```{r}
grades <- read_csv("grades.csv")
```

Question 2:

```{r}
total_grades <- grades |> summarise(total=n()) |> pull(total)
paste("The dataset contains", total_grades, "grades")
```

Question 3:

```{r}
num_students <- grades |> distinct(id) |> summarise(n = n()) |> pull(n)
paste("The dataset contains", num_students , "students")
```

Question 4:

```{r}
#| message: false
students <- grades |> select(id, group) |> distinct(id, group) 
```

```{r}
students |> slice_tail(n = 5) |> knitr::kable()
```


Question 5:

```{r}
ggplot(students, aes(x = group)) + 
  geom_bar()+
  labs(title = "Number of Students per Group", 
       x = "Group", 
       y = "Number of Students")
```

Question 6:

```{r}
average_Rune_Glyph <- grades |> filter(course == "Runecrafting and Glyphwork") |> group_by(group) |> summarise(average = mean(grade))
```

```{r}
ggplot(average_Rune_Glyph, aes(x = group, y =average)) + 
  geom_col()+
  labs(title = "Average per Group", 
       x = "Group", 
       y = "Grade")
```

Question 7:





Question 8:


```{r}
grades |> group_by(id, group) |> summarise(n = n()) |> head(10)
```

```{r}
grades_stat <- grades |> group_by(id, group) |> summarise(min_grade = min(grade), max_grade = max(grade), mean_grade = mean(grade), median_grade = median(grade) )
```

```{r}
library(knitr)
print(kable(grades_stat, format = "markdown", caption = "Summary Statistics of Grades per Student"))
```

Question 9:

```{r}
#|mmessage: false
nb_grades_necromancy <- grades |> filter(course == "Necromancy and Spirit Summoning") |> group_by(id, group) |> summarise(n =n()) 
```

```{r}
nb_grades_necromancy |> head(10)
```







